<!DOCTYPE html>
<html class="no-js" lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Factorizaciones positivas de matrices igualmente positivas - datanalytics</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Factorizaciones positivas de matrices igualmente positivas" />
<meta property="og:description" content="Cuando tenía 18 años, pensaba, llegué a aprender todo lo que había que saber sobre factorización de matrices. Incluida la inutilidad de Jordan. El otro día, con un ciento y pico por ciento más de años, he descubierto una clase entera de factorizaciones que aquellos planes de estudios viejunos no contemplaban y que, ¡carajo!, aparte de útiles engarzan con otras ideas la mar de interesantes.
Se trata de factorizaciones positivas de matrices igualmente positivas." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/2014/06/19/factorizaciones-positivas-de-matrices-igualmente-positivas/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-06-19T07:01:38&#43;00:00" />
<meta property="article:modified_time" content="2014-06-19T07:01:38&#43;00:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Alegreya:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="datanalytics" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">datanalytics</div>
					<div class="logo__tagline">Estadística y análisis de datos</div>
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Factorizaciones positivas de matrices igualmente positivas</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2014-06-19T07:01:38Z">2014-6-19</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/estad%C3%ADstica/" rel="category">estadística</a>, <a class="meta__link" href="/categories/r/" rel="category">r</a>
	</span>
</div></div>
		</header>
		<div class="content post__content clearfix">
			<p>Cuando tenía 18 años, pensaba, llegué a aprender todo lo que había que saber sobre factorización de matrices. Incluida la <a href="http://en.wikipedia.org/wiki/Jordan_normal_form">inutilidad de Jordan</a>. El otro día, con un ciento y pico por ciento más de años, he descubierto una clase entera de factorizaciones que aquellos planes de estudios viejunos no contemplaban y que, ¡carajo!, aparte de útiles engarzan con otras ideas la mar de interesantes.</p>
<p>Se trata de factorizaciones positivas de matrices igualmente positivas.</p>
<p>Y no, las matrices positivas, es decir, sin elementos negativos, no son una rareza: piénsese en las tabulaciones (o tablas de contingencia).</p>
<p>Al grano. Dada $latex A =(a_{ij})$ donde cada $latex a_{ij} &gt; 0$ es posible encontrar dos matrices $latex W$ y $latex H$ también positivas tales que $latex A \approx WH$. La no demostración por ejemplo y construcción mediante caja negra es la siguiente:</p>
<pre><code>library(MASS)
library(&lt;a href=&quot;http://inside-r.org/packages/cran/NMF&quot;&gt;NMF)
 
a &lt;- as.matrix(caith)
res &lt;- &lt;a href=&quot;http://inside-r.org/packages/cran/NMF&quot;&gt;nmf(a, rank = 2)
 
a
 
# fair red medium dark black
# blue    326  38    241  110     3
# light   688 116    584  188     4
# medium  343  84    909  412    26
# dark     98  48    403  681    85
 
res@fit@W %*% res@fit@H
 
# fair       red   medium      dark     black
# blue   276.37021  45.58136 296.3578  96.37782  3.312852
# light  635.93433 102.81758 656.0355 182.10365  3.108965
# medium 456.68567  92.14988 700.5967 482.32648 42.241237
# dark    86.00979  45.45118 484.0100 630.19204 69.336946
</code></pre>
<p>Lo del algoritmo es lo de menos. Hay muchos y diversos que pueden consultarse en la bibliografía que acompaña al paquete anterior y en muchas otras partes.</p>
<p>También es medio irrelevante lo de la pérdida de la ortogonalidad (aunque véase <a href="http://www.datanalytics.com/2011/08/12/una-feliz-conjuncion-estadistico-algebraica/">esto</a> y <a href="http://www.datanalytics.com/2011/08/16/una-feliz-conjuncion-estadistico-algebraica-y-ii/">esto</a> para ver cómo otro tipo de factorizaciones más convencionales se relaciona con lo de la milonga de la $latex \chi^2$) por lo que se gana. Que es, dividiendo filas y columnas adecuadamente, esto:</p>
<p>$latex A \approx WH= DW^\prime H^\prime$</p>
<p>donde $latex D$ es una matriz diagonal positiva y $latex W^\prime$ y $latex H^\prime$ son matrices positivas cuyas filas suman 1: ¡son probabilidades!</p>
<p>En concreto, las filas de $latex H^\prime$ son funciones de probabilidad sobre las filas de $latex A$ y las filas de $latex W^\prime$ determinan el peso de las anteriores en la <em>mixtura</em> que <em>genera</em> cada una de ellas. Es decir, se cuenta con un <em>modelo generativo</em> de la matriz (o tabla de contingencia). Los valores de la diagonal de $latex D$, por su parte, indican de alguna manera cuántas observaciones hay en cada fila, es decir, cuántas veces tengo que muestrear cada fila.</p>
<p>Y esto, a su vez, es puro <a href="http://en.wikipedia.org/wiki/Latent_Dirichlet_allocation">LDA</a> y entronca con otra familia entera de algoritmos, muchos de ellos bayesianos en espíritu, para el análisis de cosas que son (pero que la gente no llama así cuando tienen las dimensiones que uno encuentra en la práctica) tablas de contingencia.</p>
<p>Temo no haber sido claro. A ver si otro día me encuentro más animado para escribir y explico con un ejemplo elaborado cómo se puede obtener muestras de $latex A$ usando el modelo anterior.</p>
<p>Termino comentando para qué podría servir lo anterior y que no se piense hablo por hablar. Supóngase que las filas son clientes y que las columnas son productos que estos han comprado en cierto periodo de tiempo. La descomposición anterior revelaría factores no explícitos (las distribuciones de probabilidad sobre las filas) que hacen que algunos clientes compren determinados productos (juntos) y no otros; luego cada cliente tendría asignada una cierta propensión (dada por las filas de la matriz $latex W^\prime$) a cada uno de los factores.</p>
<p>Algunas cuestiones adicionales que me planteo respecto al asunto de hoy se refieren a, por ejemplo:</p>
<pre><code>  * La unicidad (material) de la representación
  * Su estabilidad
  * La posibilidad de incrementar el número de ceros en las matrices (de manera similar a como se hace con las rotaciones de los componentes principales)
</code></pre>
<ul>
<li>Si eso que llaman trabajo pero que, en el fondo, es solo ruido, me va a dejar tiempo para seguir indagando en la materia</li>
<li>Cómo demonios voy a factorizar algunas matrizotas que tengo en el disco duro</li>
</ul>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/estad%C3%ADstica/" rel="tag">estadística</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/factorizaci%C3%B3n/" rel="tag">factorización</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/matrices/" rel="tag">matrices</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/nmf/" rel="tag">nmf</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/2014/06/16/tan-actual-25-anos-despues/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Anterior</span>
			<p class="pager__title">Tan actual 25 años después</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/2014/06/23/grupo-de-usuarios-de-r-de-portugal/" rel="next">
			<span class="pager__subtitle">Siguiente&thinsp;»</span>
			<p class="pager__title">Grupo de usuarios de R de Portugal</p>
		</a>
	</div>
</nav>


			</div>
			<aside class="sidebar">
<div class="widget-recent widget">
	<h4 class="widget__title">Más Recientes</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/2021/12/09/mas-sobre-exceso-mortalidad-noviembre-2021/">Sobre el exceso de mortalidad en noviembre de 2021</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/12/09/mas-sobre-la-estimacion-de-probabilidades-de-eventos-que-no-se-repiten/">Más sobre la estimación de probabilidades de eventos que no se repiten</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/12/07/estadistica-vs-siquiatria-la-aparente-contradiccion-la-profunda-sintesis/">Estadística vs siquiatría: la aparente contradicción, la profunda síntesis</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/12/02/por-que-cabe-argumentar-que-estos-resultados-infraestiman-la-efectividad-de-las-vacunas-contra-el-covid/">¿Por qué cabe argumentar que estos resultados infraestiman la efectividad de las vacunas contra el covid?</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/11/25/un-episodio-relevante-para-estas-paginas-extraido-de-un-espia-perfecto/">Un episodio relevante para estas páginas extraído de &#34;Un espía perfecto&#34;</a></li>
		</ul>
	</div>
</div>
</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2021 datanalytics.
      
		</div>
	</div>
</footer>

	</div>
<script async defer src="/js/menu.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({ tex2jax: {inlineMath: [["$","$"], ["$latex", "$"],["\\(","\\)"]]} })
</script>

</body>
</html>