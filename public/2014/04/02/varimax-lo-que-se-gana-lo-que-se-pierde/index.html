<!DOCTYPE html>
<html class="no-js" lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Varimax: lo que se gana, lo que se pierde - datanalytics</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Varimax: lo que se gana, lo que se pierde" />
<meta property="og:description" content="Hoy hablaremos de exploratory factorial analysis y en particular aprovecharé para dejar constancia de que dejo resuelta una duda que siempre me ha dado pereza resolver: qué se pierde —lo que se gana ya nos lo han contado por doquier— al realizar una rotación varimax.
Comencemos. Primero, voy a realizar un análisis factorial (exploratorio) basándome en ?varimax:
fa &lt;- &lt;a href=&quot;http://inside-r.org/r-doc/stats/factanal&quot;&gt;factanal( ~., 2, data = &lt;a href=&quot;http://inside-r.org/r-doc/datasets/swiss&quot;&gt;swiss, rotation = &quot;none&quot;) fa # Call: # factanal(x = ~." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/2014/04/02/varimax-lo-que-se-gana-lo-que-se-pierde/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-04-02T07:50:42&#43;00:00" />
<meta property="article:modified_time" content="2014-04-02T07:50:42&#43;00:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Alegreya:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="datanalytics" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">datanalytics</div>
					<div class="logo__tagline">Estadística y análisis de datos</div>
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Varimax: lo que se gana, lo que se pierde</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2014-04-02T07:50:42Z">2014-4-2</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/estad%C3%ADstica/" rel="category">estadística</a>
	</span>
</div></div>
		</header>
		<div class="content post__content clearfix">
			<p>Hoy hablaremos de <a href="http://en.wikipedia.org/wiki/Exploratory_factor_analysis"><em>exploratory factorial analysis</em></a> y en particular aprovecharé para dejar constancia de que dejo resuelta una duda que siempre me ha dado pereza resolver: qué se pierde —lo que se gana ya nos lo han contado por doquier— al realizar una <a href="http://en.wikipedia.org/wiki/VARIMAX">rotación varimax</a>.</p>
<p>Comencemos. Primero, voy a realizar un análisis factorial (exploratorio) basándome en <code>?varimax</code>:</p>
<pre><code>fa &lt;- &lt;a href=&quot;http://inside-r.org/r-doc/stats/factanal&quot;&gt;factanal( ~., 2, data = &lt;a href=&quot;http://inside-r.org/r-doc/datasets/swiss&quot;&gt;swiss, rotation = &quot;none&quot;)
fa

# Call:
#   factanal(x = ~., factors = 2, data = swiss, rotation = &quot;none&quot;)
#
# Uniquenesses:
#   Fertility      Agriculture      Examination        Education         Catholic Infant.Mortality
# 0.420            0.492            0.270            0.005            0.061            0.960
#
# Loadings:
#   Factor1 Factor2
# Fertility        -0.674   0.356
# Agriculture      -0.648   0.297
# Examination       0.713  -0.471
# Education         0.997
# Catholic         -0.178   0.953
# Infant.Mortality -0.104   0.169
#
# Factor1 Factor2
# SS loadings      2.419   1.373
# Proportion Var   0.403   0.229
# Cumulative Var   0.403   0.632
#
# Test of the hypothesis that 2 factors are sufficient.
# The chi square statistic is 20.99 on 4 degrees of freedom.
# The p-value is 0.000318
</code></pre>
<p>Usando <code>factanal</code> he creado dos factores sobre el conjunto de datos <code>swiss</code> y he optado por no usar nigún tipo de rotación.</p>
<p>Dos notas al respecto. La primera es que <code>factanal</code> no utiliza PCA internamente para obtener los factores. Existe cierta confusión entre el análisis factorial y el de los componentes principales (véase <a href="http://en.wikipedia.org/wiki/Factor_analysis#Exploratory_factor_analysis_versus_principal_components_analysis">esto</a> al respecto) a la que pudiera haber contribuido el hecho de que en SPSS (o al menos, ciertas versiones) el análisis de componentes principales es un <em>modo</em> (al menos, está en el mismo menú y bajo el epígrafe <em>factores</em>) del análisis factorial. De hecho, <a href="http://www.unt.edu/rss/class/Jon/SPSS_SC/Module9/M9_PCA/SPSS_M9_PCA1.htm">en SPSS un análisis factorial con las opciones por defecto es un PCA</a>.</p>
<p>El segundo es que en el análisis factorial los factores son ortogonales por definición y construcción. Aunque bien es cierto que existen técnicas de <em>rotación</em> no ortogonales que hacen que los factores finales pierdan esa siempre conveniente propiedad.</p>
<p>Retomando el asunto de la entrada y abundando en la segunda nota, una vez obtenidos los resultados anteriores, es posible plantearse el <em>rotar</em> los factores obtenidos. En efecto, los factores obtenidos son únicos salvo por rotaciones. Dicho de otro modo, cualquier rotación de los obtenidos es un conjunto de factores <em>igual de válido</em> que el orginal. Cómo no, cierta gente las utiliza de oficio —en ocasiones subrepticiamente: incluso en R, la función <em>factanal</em> rota los factores si no se indica explícitamente lo contrario&hellip; ¡y qué no harán SPSS, SAS y demás!— para aliñar su ensalada de factores.</p>
<p>(Otra nota: invito a mis lectores a sopesar los efectos de las rotaciones subrepticias sobre la reproducibilidad, esa propiedad tan deseable de los análisis estadísticos).</p>
<p>Rotaciones como las que produce varimax facilitan la <em>interpretabilidad</em> de los factores. Tienden a aplastar los coeficientes pequeños y a hacer crecer los grandes de manera que sus <em>perfiles</em> pueden asociarse más fácilmente a un subconjunto concreto de variables. Estos subconjuntos de variables más involucradas en un factor determinado permiten intuir un significado y, esto es muy importante en ciertos ámbitos, asociarles un nombre.</p>
<p>Pero, ¿qué se pierde? Veámoslo:</p>
<pre><code>&lt;a href=&quot;http://inside-r.org/r-doc/stats/varimax&quot;&gt;varimax(&lt;a href=&quot;http://inside-r.org/r-doc/stats/loadings&quot;&gt;loadings(fa), normalize = FALSE)
# $loadings
#
# Loadings:
#   Factor1 Factor2
# Fertility        -0.650   0.398
# Agriculture      -0.628   0.337
# Examination       0.681  -0.515
# Education         0.997
# Catholic         -0.117   0.962
# Infant.Mortality          0.176
#
# Factor1 Factor2
# SS loadings      2.297   1.495
# Proportion Var   0.383   0.249
# Cumulative Var   0.383   0.632
#
# $rotmat
# [,1]        [,2]
# [1,] 0.99796647 -0.06374102
# [2,] 0.06374102  0.99796647
</code></pre>
<p>Los coeficientes de los factores han cambiado. El artefacto —de impredecibles consecuencias— consistente en omitir los coeficientes menores en valor absoluto que 0.1 oculta el de la variable <code>Infant.Mortality</code> en el segundo caso (y da la impresión, errónea por otro lado, de que el primer factor no depende de ella). Etc. Por otro lado, la varianza explicada acumulada no ha variado: 63.2%.</p>
<p>Entonces, ¿qué se ha perdido? La varianza explicada por el primer factor, 40.3% ha descendido al 38.3%. Los factores principales ya no se orientan en las direcciones (en orden descendiente) de máxima variación sino que se reorientan en función de otros objetivos que el algoritmo original no tenía en cuenta y esta se distribuye más homogéneamente entre todos los factores.</p>
<p>Y acabo con una reflexión: ¿cómo afecta la rotación al <em>screeplot</em>? Y dado que este puede usarse como criterio para seleccionar el número de factores relevantes, ¿cómo estarán afectando en la práctica las rotaciones (subrepticias en muchas ocasiones) a la selección del número de factores que conservar? ¿Tiene sentido estudiar el <em>screeplot</em> después de efectuada la rotación?</p>
<p>Nota: Me he basado en <a href="http://sites.stat.psu.edu/~ajw13/stat505/fa06/17_factor/13_factor_varimax.html">este artículo</a> pero he preferido escribir aquí mi propio código reproducible gratuitamente.</p>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/an%C3%A1lisis-factorial/" rel="tag">análisis factorial</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/componentes-principales/" rel="tag">componentes principales</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/estad%C3%ADstica/" rel="tag">estadística</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/varianza/" rel="tag">varianza</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/varimax/" rel="tag">varimax</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/2014/04/01/componentes-principales-para-quienes-cursaron-algebra-de-primero-con-aprovechamiento/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Anterior</span>
			<p class="pager__title">Componentes principales para quienes cursaron álgebra de primero con aprovechamiento</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/2014/04/03/the-elements-of-statistical-artisany/" rel="next">
			<span class="pager__subtitle">Siguiente&thinsp;»</span>
			<p class="pager__title">The Elements of Statistical Craftsmanship</p>
		</a>
	</div>
</nav>


			</div>
			<aside class="sidebar">
<div class="widget-recent widget">
	<h4 class="widget__title">Más Recientes</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/2021/12/09/mas-sobre-exceso-mortalidad-noviembre-2021/">Sobre el exceso de mortalidad en noviembre de 2021</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/12/09/mas-sobre-la-estimacion-de-probabilidades-de-eventos-que-no-se-repiten/">Más sobre la estimación de probabilidades de eventos que no se repiten</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/12/07/estadistica-vs-siquiatria-la-aparente-contradiccion-la-profunda-sintesis/">Estadística vs siquiatría: la aparente contradicción, la profunda síntesis</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/12/02/por-que-cabe-argumentar-que-estos-resultados-infraestiman-la-efectividad-de-las-vacunas-contra-el-covid/">¿Por qué cabe argumentar que estos resultados infraestiman la efectividad de las vacunas contra el covid?</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/11/25/un-episodio-relevante-para-estas-paginas-extraido-de-un-espia-perfecto/">Un episodio relevante para estas páginas extraído de &#34;Un espía perfecto&#34;</a></li>
		</ul>
	</div>
</div>
</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2021 datanalytics.
      
		</div>
	</div>
</footer>

	</div>
<script async defer src="/js/menu.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({ tex2jax: {inlineMath: [["$","$"], ["$latex", "$"],["\\(","\\)"]]} })
</script>

</body>
</html>