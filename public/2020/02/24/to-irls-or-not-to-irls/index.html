<!DOCTYPE html>
<html class="no-js" lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>To IRLS or not to IRLS - datanalytics</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="To IRLS or not to IRLS" />
<meta property="og:description" content="A veces tomas un artículo de vaya uno a saber qué disciplina, sismología, p.e., y no dejas de pensar: los métodos estadísticos que usa esta gente son de hace 50 años. Luego cabe preguntarse: ¿pasará lo mismo en estadística con respecto a otras disciplinas?
Por razones que no vienen al caso, me he visto en la tesitura de tener que encontrar mínimos de funciones que podrían cuasicatalogarse como de mínimos cuadrados no lineales." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/2020/02/24/to-irls-or-not-to-irls/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-02-24T09:13:00&#43;00:00" />
<meta property="article:modified_time" content="2020-02-24T09:13:00&#43;00:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Alegreya:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="datanalytics" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">datanalytics</div>
					<div class="logo__tagline">Estadística y análisis de datos</div>
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">To IRLS or not to IRLS</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2020-02-24T09:13:00Z">2020-2-24</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/estad%C3%ADstica/" rel="category">estadística</a>, <a class="meta__link" href="/categories/r/" rel="category">r</a>
	</span>
</div></div>
		</header>
		<div class="content post__content clearfix">
			<p>A veces tomas un artículo de vaya uno a saber qué disciplina, sismología, p.e., y no dejas de pensar: los métodos estadísticos que usa esta gente son de hace 50 años. Luego cabe preguntarse: ¿pasará lo mismo en estadística con respecto a otras disciplinas?</p>
<p>Por razones que no vienen al caso, me he visto en la tesitura de tener que encontrar mínimos de funciones que podrían cuasicatalogarse como de mínimos cuadrados no lineales. Y por algún motivo, pareciere que no hubiese en el mundo un algoritmo de ajuste que no fuese <a href="https://en.wikipedia.org/wiki/Iteratively_reweighted_least_squares">IRLS</a>. Que tiene una gran tradición en estadística; es, de hecho, la base de la optimización propuesta por <a href="https://www.semanticscholar.org/paper/Generalized-Linear-Models-McCullagh-Nelder/458dd9b463f0fb0d7c52ff20601eaaa9ebfebc99">Nelder y McCullagh en 1972</a>.</p>
<p>Pero, ¿tiene sentido seguir haciendo IRLS <strong>hoy</strong>? ¿O ha quedado estancada la estadística en técnicas de optimización setenteras por un tonto apego a la tradición? ¿Zumba la CPU al ritmo de <em>The Great Gig in the Sky</em> cuando ejecuta el Fortran que subyace a <code>glm</code> en R?</p>
<p>La verdad, estoy perdido. Por un lado, en ninguna de las casi 700 páginas de la segunda edición del libro <em><a href="https://books.google.es/books/about/Numerical_Optimization.html?id=eNlPAAAAMAAJ">Numerical Optimization</a></em>, el de Nocedal, aparece una sola mención a IRLS. Pero igual un libro genérico de optimización no puede entrar en detalle en problemas muy particulares, en la que la función de la que se busca el mínimo tiene una forma muy particular: una suma de cuadrados de residuos o algo que se parece mucho a ello.</p>
<p>En un libro más especializado, Numerical Methods of Statistics (de Monahan), hay dos menciones en casi 500 páginas. Y lo hace al describir los métodos (clásicos) usados para ajustar GLMs. Ninguna, sin embargo, en la sección de optimización y ecuaciones no lineales.</p>
<p>La función <code>MASS::rls</code> (la versión robusta de <code>lm</code> en <code>MASS</code>) usa IRLS. Sin embargo, mis LS no son lineales. En <code>robustbase</code>, un paquete mucho más específico y moderno, la función <code>nlrob</code>, que <em>casi</em> hace lo que pretendo, usa <code>DEoptimR::JDEoptim</code> para encontrar valores iniciales decentes y el L-<code>BFGS-B</code> de <code>optim</code> de toda la vida para afinarla.</p>
<p>Así que, en resumen, tengo la sospecha de en estadística deberíamos <em>aggiornarnos</em>, deshacernos de IRLS e ir adoptando optimizadores <em>de caja negra</em> decentes que nos proporcionen nuestros colegas los matemáticos aplicados. Pero igual me equivoco.</p>
<p>¿Me leerá algún matemático especialista en la cosa y sin el vicio de la perífrasis que me pueda sacar de dudas?</p>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/deoptimr/" rel="tag">deoptimr</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/mass/" rel="tag">mass</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/matem%C3%A1ticas/" rel="tag">matemáticas</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/optim/" rel="tag">optim</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/optimizaci%C3%B3n/" rel="tag">optimización</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/paquetes/" rel="tag">paquetes</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/r/" rel="tag">r</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/robustbase/" rel="tag">robustbase</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/2020/02/21/platon-en-el-estercolero/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Anterior</span>
			<p class="pager__title">Platón en el estercolero</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/2020/02/26/algoritmos-y-acatarrantes-definiciones-de-justicia/" rel="next">
			<span class="pager__subtitle">Siguiente&thinsp;»</span>
			<p class="pager__title">&#34;Algoritmos&#34; y acatarrantes definiciones de &#34;justicia&#34;</p>
		</a>
	</div>
</nav>


			</div>
			<aside class="sidebar">
<div class="widget-recent widget">
	<h4 class="widget__title">Más Recientes</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/2021/12/09/mas-sobre-exceso-mortalidad-noviembre-2021/">Sobre el exceso de mortalidad en noviembre de 2021</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/12/09/mas-sobre-la-estimacion-de-probabilidades-de-eventos-que-no-se-repiten/">Más sobre la estimación de probabilidades de eventos que no se repiten</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/12/07/estadistica-vs-siquiatria-la-aparente-contradiccion-la-profunda-sintesis/">Estadística vs siquiatría: la aparente contradicción, la profunda síntesis</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/12/02/por-que-cabe-argumentar-que-estos-resultados-infraestiman-la-efectividad-de-las-vacunas-contra-el-covid/">¿Por qué cabe argumentar que estos resultados infraestiman la efectividad de las vacunas contra el covid?</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/11/25/un-episodio-relevante-para-estas-paginas-extraido-de-un-espia-perfecto/">Un episodio relevante para estas páginas extraído de &#34;Un espía perfecto&#34;</a></li>
		</ul>
	</div>
</div>
</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2021 datanalytics.
      
		</div>
	</div>
</footer>

	</div>
<script async defer src="/js/menu.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({ tex2jax: {inlineMath: [["$","$"], ["$latex", "$"],["\\(","\\)"]]} })
</script>

</body>
</html>