<!DOCTYPE html>
<html class="no-js" lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Apuntes para el estudio del impacto del cierre de la central nuclear de Garoña en el precio de la electricidad en España - datanalytics</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Apuntes para el estudio del impacto del cierre de la central nuclear de Garoña en el precio de la electricidad en España" />
<meta property="og:description" content="Nada más ni nada menos.
Vaya por delante, en mi descargo y como aviso para los que se cansan más de leer textos largos y complejos que de opinar, que no es un estudio completo. Realmente, solo voy a proporcionar herramientas para que otros con más tiempo e interés sobre el asunto las tomen si les parecen adecuadas, las limpien de errores y omisiones, se pongan a la faena y, con suerte, puedan llegar a resultados que tengan a bien publicar para iluminarnos a todos." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/2021/07/28/apuntes-para-el-estudio-del-impacto-del-cierre-de-la-central-nuclear-de-garona-en-el-precio-de-la-electricidad-en-espana/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-28T09:17:09&#43;00:00" />
<meta property="article:modified_time" content="2021-07-28T09:17:09&#43;00:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Alegreya:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="datanalytics" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">datanalytics</div>
					<div class="logo__tagline">Estadística y análisis de datos</div>
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Apuntes para el estudio del impacto del cierre de la central nuclear de Garoña en el precio de la electricidad en España</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2021-07-28T09:17:09Z">2021-7-28</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/n%C3%BAmeros/" rel="category">números</a>, <a class="meta__link" href="/categories/varios/" rel="category">varios</a>
	</span>
</div></div>
		</header>
		<div class="content post__content clearfix">
			<p>Nada más ni nada menos.</p>
<p>Vaya por delante, en mi descargo y como aviso para los que se cansan más de leer textos largos y complejos que de opinar, que no es un estudio completo. Realmente, solo voy a proporcionar herramientas para que otros con más tiempo e interés sobre el asunto las tomen si les parecen adecuadas, las limpien de errores y omisiones, se pongan a la faena y, con suerte, puedan llegar a resultados que tengan a bien publicar para iluminarnos a todos. El asunto, a todo esto, es un contrafactual: qué podría estar sucediendo con los beneméritos precios del mercado eléctrico español de seguir la central nuclear de Garoña (recuérdese: 460 MW de potencia) en funcionamiento.</p>
<p>He utilizado los <a href="https://www.omie.es/es/file-access-list?parents%5B0%5D=/&amp;parents%5B1%5D=Mercado%20Diario&amp;parents%5B2%5D=3.%20Curvas&amp;dir=Curvas%20agregadas%20de%20oferta%20y%20demanda%20del%20mercado%20diario&amp;realdir=curva_pbc">datos</a> correspondientes al día en que escribo, el de Santiago de 2021, que son los que subyacen a estas horribles curvas de demanda (<a href="https://www.omie.es/es/market-results/daily/daily-market/aggragate-suply-curves?scope=daily&amp;date=2021-07-25&amp;hour=12">enlace</a>) con las que OMIE trata de —y sin duda, lo logra— confundirnos:</p>
<p><img src="https://www.datanalytics.com/wp-uploads/2021/07/curvas_demanda_sector_electrico-1024x558.png" alt=""></p>
<p><em>[¿En serio colocan el precio en las ordenadas y la energía en las abscisas? ¿En serio tienen que representar datos alejadísimos de los precios de casación? Quienquiera que haya tomado esas decisiones, necesita un consultor urgentemente.]</em></p>
<p>En concreto, he bajado el fichero del día y lo he preprocesado así (porque, pobrecito, lo tiene todo: <em>encoding</em> de Windows, dos líneas de encabezado con metadatos prescindibles, cifras en formato RAE, una fila de más, una columna de más, etc.):</p>
<pre><code>raw &lt;- read.table(&quot;curva_pbc_20210725.1&quot;, sep = &quot;;&quot;,
                  dec = &quot;,&quot;, skip = 2, header = T,
                  fileEncoding = &quot;latin1&quot;)

dat &lt;- raw
dat$Fecha &lt;- NULL
dat$Pais &lt;- NULL
dat$Unidad &lt;- NULL
dat$X &lt;- NULL

dat &lt;- dat[-nrow(dat),]

colnames(dat) &lt;- c(&quot;hora&quot;, &quot;cv&quot;, &quot;amount&quot;, &quot;price&quot;, &quot;oc&quot;)

dat$amount &lt;- gsub(&quot;\\.&quot;, &quot;&quot;, dat$amount)
dat$amount &lt;- as.numeric(gsub(&quot;,&quot;, &quot;.&quot;, dat$amount))
dat$price &lt;- gsub(&quot;\\.&quot;, &quot;&quot;, dat$price)
dat$price  &lt;- as.numeric(gsub(&quot;,&quot;, &quot;.&quot;, dat$price))

dat12 &lt;- dat[dat$hora == 12,]
dat12$hora &lt;- NULL
</code></pre>
<p>Las siguientes líneas ordenan las órdenes de compra y venta, calculan la cantidad acumulada convenientemente y crean la gráfica de oferta y demanda sobre los ejes <em>que son</em> y marcan el precio del mercado:</p>
<pre><code>venta &lt;- dat12[dat12$cv == 'V' &amp; dat12$oc == &quot;O&quot;,]
venta &lt;- venta[order(venta$price),]
venta$acum &lt;- cumsum(venta$amount)

compra &lt;- dat12[dat12$cv == 'C' &amp; dat12$oc == &quot;O&quot;,]
compra &lt;- compra[order(-compra$price),]
compra$acum &lt;- cumsum(compra$amount)

plot(venta$price, venta$acum, type = &quot;l&quot;, xlim = c(0, 100),
     xlab = &quot;precio&quot;, ylab = &quot;MWh&quot;,
     main = &quot;Oferta y demanda del mercado eléctrico\nespañol (2021-07-25, 12h)&quot;)
lines(compra$price, compra$acum, col = &quot;red&quot;)
abline(v = max(venta$price[venta$acum &lt; approx(compra$price, compra$acum, venta$price)$y]))
</code></pre>
<p>Es decir, generan esto:</p>
<p><img src="https://www.datanalytics.com/wp-uploads/2021/07/curva_oferta_demanda_00.png" alt=""></p>
<p><em>[¿A que no se parecen a las de los libros que se enseñan en esas facultades donde los profes enseñan una cosa por la mañana y escriben un artículo en El País por la tarde sosteniendo exactamente lo contrario?]</em></p>
<p>Luego, puedo construir el contrafactual, donde a la oferta le sumo los 460 MW de la extinta central de Garoña (en azul). Para ello, uso</p>
<pre><code>plot(venta$price, venta$acum, type = &quot;l&quot;, xlim = c(0, 100),
     xlab = &quot;precio&quot;, ylab = &quot;MWh&quot;,
     main = &quot;Oferta y demanda contrafactuales del\nmercado eléctrico español (2021-07-25, 12h)&quot;)
lines(compra$price, compra$acum, col = &quot;red&quot;)
lines(venta$price, venta$acum + 460, col = &quot;blue&quot;)
abline(v = max(venta$price[venta$acum &lt; approx(compra$price, compra$acum, venta$price)$y]))
abline(v = max(venta$price[venta$acum + 460 &lt; approx(compra$price, compra$acum, venta$price)$y]), col = &quot;blue&quot;)
</code></pre>
<p>y obtengo</p>
<p><img src="https://www.datanalytics.com/wp-uploads/2021/07/curva_oferta_demanda_01.png" alt=""></p>
<p>En términos de oferta, Garoña es casi inapreciable (¡un saludo desde aquí a los cuarentones que estén estrenando problemas de visión!) pero la curva de demanda es tan plana, que el impacto sobre el precio mayorista es muy significativo: tres euros.</p>
<p>Sé que los hipertacañones expertos en el funcionamiento del mercado eléctrico estarán ahora hiperventilando (los saludo también: durante un breve periodo, hace muchos años, fuimos también colegas y la consultoría en el mercado eléctrico, recién estrenado en aquellas fechas, ha pagado, como poco, un palmo cuadrado de mi otra hipoteca). De hecho, el precio que obtengo arriba, 52€/MWh, no es el real del mercado en la hora en cuestión, que es de unos 86€/MWh .</p>
<p>Sucede así porque el operador del mercado excluye algunas ofertas baratas e introduce otras más caras por motivos técnicos de todo tipo. Por ejemplo, porque hay centrales que no se pueden enchufar y desenchufar a voluntad (y si las necesitas en una hora concreta, les tienes que comprar también energía en las horas colindantes), por razones de distribución geográfica, etc. Así que las ofertas efectivamente casadas no son las que aparecen en el gráfico anterior sino otras (que OMIE tiene la gentileza de identificar convenientemente con una C).</p>
<p>Por lo que si hago</p>
<pre><code>vendida &lt;-  dat12[dat12$cv == &quot;V&quot; &amp; dat12$oc == &quot;C&quot;,]
vendida &lt;- vendida[order(-vendida$price),]
vendida$acum &lt;- cumsum(vendida$amount)
</code></pre>
<p>puedo ver las ofertas efectivamente casadas de la más cara a la más barata. Un extracto de las primeras, por centrar ideas, es:</p>
<pre><code>head(vendida)
#       cv amount price oc acum
# 40124  V   44.2 86.47  C 44.2
# 40123  V   22.0 86.40  C 66.2
# 40122  V   11.5 86.23  C 77.7
# 40114  V    0.4 85.20  C 78.1
# 40115  V    1.3 85.20  C 79.4
# 40116  V    8.1 85.20  C 87.5
</code></pre>
<p>Y si excluyo los primeros 460 MW más caros, llego a un precio de 77.36€/MWh (vs 86.47€/MWh excluyendo Garoña). Vamos, en números redondos, un 11% más caro en esa hora concreta.</p>
<p>Obviamente, he dado por buenas una serie de hipótesis muy convenientes para las tesis de algunos. Se podría argumentar que Garoña no tendría que desplazar necesariamente toda esa energía tan cara y que alguna de ella podría seguir siendo necesaria, etc. Y sí, casi seguro que todas estas objeciones son verdaderas en algún grado.</p>
<p>Pero como no he visto el análisis del impacto del cierre de las centrales nucleares sobre el precio del <em>pool</em> por ningún lado, he tirado de mis diletancias por ver si, provocando, alguno recoge el guante y como digo arriba, aprendemos todos.</p>
<p><strong>Coda:</strong> Escribí el texto anterior hace unos días y me ha dado tiempo de repensarlo antes de publicarlo. La primera neo-conclusión es que el mercado eléctrico no es, como se dice, marginalista. O que su marginalismo está muy condicionado por las restricciones técnicas del sistema y que las órdenes no se casan como en la bolsa sino, intuyo, resolviendo un problema de optimización del bien conocido tipo minimiza el coste sujeto a tales condiciones. Y los que tenemos experiencia con ellos sabemos que es prácticamente imposible formularlo y resolverlo exactamente y que las heurísticas las carga el diablo. Es de esperar, en todo caso, que quienquiera que sea el encargado de supervisarlo no esté empachado de cenas finas a cuenta de otro a estas alturas de su carrera profesional.</p>
<p>La segunda es que un mercado no se conoce hasta que no se le encuentran las trampas. Estoy seguro de que en este, como en otros que conozco, existen <em>trucos</em> por los que un operador puede extraer un beneficio ateniéndose a la norma de la cosa aunque no a su espíritu. Sería muy ilustrativo que alguien que lo conozca a fondo compartiese con todos algunos ejemplos.</p>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/energ%C3%ADa-nuclear/" rel="tag">energía nuclear</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/garo%C3%B1a/" rel="tag">garoña</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/mercado-el%C3%A9ctrico/" rel="tag">mercado eléctrico</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/n%C3%BAmeros/" rel="tag">números</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/2021/07/21/quien-invento-los-random-forests/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Anterior</span>
			<p class="pager__title">¿Quién inventó los &#34;random forests&#34;?</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/2021/08/12/nuevo-video-en-youtube-sobre-la-regla-de-tres-en-particular-y-sobre-la-educacion-en-espana-en-general/" rel="next">
			<span class="pager__subtitle">Siguiente&thinsp;»</span>
			<p class="pager__title">Nuevo vídeo en YouTube: sobre la regla de tres (en particular) y sobre la educación en España (en general)</p>
		</a>
	</div>
</nav>


			</div>
			<aside class="sidebar">
<div class="widget-recent widget">
	<h4 class="widget__title">Más Recientes</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/2021/12/09/mas-sobre-exceso-mortalidad-noviembre-2021/">Sobre el exceso de mortalidad en noviembre de 2021</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/12/09/mas-sobre-la-estimacion-de-probabilidades-de-eventos-que-no-se-repiten/">Más sobre la estimación de probabilidades de eventos que no se repiten</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/12/07/estadistica-vs-siquiatria-la-aparente-contradiccion-la-profunda-sintesis/">Estadística vs siquiatría: la aparente contradicción, la profunda síntesis</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/12/02/por-que-cabe-argumentar-que-estos-resultados-infraestiman-la-efectividad-de-las-vacunas-contra-el-covid/">¿Por qué cabe argumentar que estos resultados infraestiman la efectividad de las vacunas contra el covid?</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/11/25/un-episodio-relevante-para-estas-paginas-extraido-de-un-espia-perfecto/">Un episodio relevante para estas páginas extraído de &#34;Un espía perfecto&#34;</a></li>
		</ul>
	</div>
</div>
</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2021 datanalytics.
      
		</div>
	</div>
</footer>

	</div>
<script async defer src="/js/menu.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({ tex2jax: {inlineMath: [["$","$"], ["$latex", "$"],["\\(","\\)"]]} })
</script>

</body>
</html>