<!DOCTYPE html>
<html class="no-js" lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Una feliz conjunción estadístico-algebraica (y II) - datanalytics</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Una feliz conjunción estadístico-algebraica (y II)" />
<meta property="og:description" content="Abandonamos el otro día nuestra discusión sobre la feliz conjunción estadístico-algebraica que subyace a esa técnica conocida como análisis de correspondencias en el punto en que habíamos descompuesto la matriz $latex B$ de la forma $latex B = PDQ^\prime$, donde $latex P$ y $latex Q$ son matrices cuyas columnas son vectores ortonormales $latex p_i$ y $latex q_j$ y $latex D$ es una matriz diagonal (aunque no necesariamente cuadrada) cuyos elementos de la diagonal (en orden decreciente) son $latex \lambda_k$." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/2011/08/16/una-feliz-conjuncion-estadistico-algebraica-y-ii/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2011-08-16T06:52:30&#43;00:00" />
<meta property="article:modified_time" content="2011-08-16T06:52:30&#43;00:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Alegreya:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="datanalytics" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">datanalytics</div>
					<div class="logo__tagline">Estadística y análisis de datos</div>
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Una feliz conjunción estadístico-algebraica (y II)</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2011-08-16T06:52:30Z">2011-8-16</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/estad%C3%ADstica/" rel="category">estadística</a>, <a class="meta__link" href="/categories/r/" rel="category">r</a>
	</span>
</div></div>
		</header>
		<div class="content post__content clearfix">
			<p>Abandonamos el otro día nuestra discusión sobre la <a href="http://www.datanalytics.com/blog/2011/08/12/una-feliz-conjuncion-estadistico-algebraica/">feliz conjunción estadístico-algebraica</a> que subyace a esa técnica conocida como análisis de correspondencias en el punto en que habíamos descompuesto la matriz $latex B$ de la forma $latex B = PDQ^\prime$, donde $latex P$ y $latex Q$ son matrices cuyas columnas son vectores ortonormales $latex p_i$ y $latex q_j$ y $latex D$ es una matriz diagonal (aunque no necesariamente cuadrada) cuyos elementos de la diagonal (en orden decreciente) son $latex \lambda_k$.</p>
<p>Entonces, la matriz $latex B$ puede descomponerse como una suma de matrices de estructura más simple de la forma $latex B = PDQ^\prime = \sum_i \lambda_i p_i q^\prime_i.$</p>
<p>En el caso que estudiábamos el otro día, podemos hacer</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R">b.i <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>( i ) svd.b<span style="color:#f92672">$</span>d[i] <span style="color:#f92672">*</span> <span style="color:#a6e22e">outer</span>( svd.b<span style="color:#f92672">$</span>u[,i], svd.b<span style="color:#f92672">$</span>v[,i] )
<span style="color:#a6e22e">b.i</span>( <span style="color:#ae81ff">1</span> ) <span style="color:#75715e"># primer sumando</span>
<span style="color:#a6e22e">b.i</span>( <span style="color:#ae81ff">2</span> ) <span style="color:#75715e"># segundo sumando</span>

b – ( <span style="color:#a6e22e">b.i</span>( <span style="color:#ae81ff">1</span> ) <span style="color:#f92672">+</span> <span style="color:#a6e22e">b.i</span>( <span style="color:#ae81ff">2</span> ) ) <span style="color:#75715e"># la aproximación es razonable con la suma de dos componentes</span></code></pre></td></tr></table>
</div>
</div>
<p>Cabe esperar que los valores más grandes de la matriz $latex B$ (es decir, las desviaciones mayores con respecto a la tabla esperada en situaciones de independencia) tengan que ver con los valores más grandes (en términos absolutos) de $latex p_1$ y $latex q_1$. En efecto, en nuestro caso, el valor más grande de B (<em>dark</em>/<em>dark</em>) es 18.53 y coincide con el cruce de la componente más alta de $latex p_1$, 0.78, y la de $latex q_1$, 0.67.</p>
<p>Nótese, además, cómo las componentes de $latex p_1$ y $latex q_1$ son (casi, casi) crecientes. De ahí que $latex \lambda_1 p_1 q^\prime_1$ recoja la estructura diagonal de la tabla y el hecho de que quienes tienen el pelo más oscuro tienden a tener, también, los ojos más oscuros.</p>
<p>Si el otro día descompusimos el valor del estadístico $latex \chi^2$ como la suma de los valores $latex \lambda_i^2$, ahora podemos advertir cómo $latex \lambda_1^2$ representa el 87 % del mismo y, por lo tanto, deducir que gran parte de la falta de independencia en la tabla se debe al efecto previamente identificado. Si tal efecto no existiese, entonces</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">pchisq</span>( <span style="color:#a6e22e">sum</span>( svd.b<span style="color:#f92672">$</span>d[<span style="color:#ae81ff">-1</span>]^2 ), (<span style="color:#a6e22e">nrow</span>( b ) <span style="color:#ae81ff">-1</span> ) <span style="color:#f92672">*</span> (<span style="color:#a6e22e">ncol</span>( b ) <span style="color:#ae81ff">-1</span> ), lower.tail <span style="color:#f92672">=</span> F )
<span style="color:#75715e"># 2.248518e-29</span></code></pre></td></tr></table>
</div>
</div>
<p>indica que la falta de independencia todavía sería significativa. Pero si no existiesen ninguno de los dos principales efectos, se tendría</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-R" data-lang="R"><span style="color:#a6e22e">pchisq</span>( <span style="color:#a6e22e">sum</span>( svd.b<span style="color:#f92672">$</span>d[<span style="color:#f92672">-</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>)]^2 ), (<span style="color:#a6e22e">nrow</span>( b ) <span style="color:#ae81ff">-1</span> ) <span style="color:#f92672">*</span> (<span style="color:#a6e22e">ncol</span>( b ) <span style="color:#ae81ff">-1</span> ), lower.tail <span style="color:#f92672">=</span> F )
<span style="color:#75715e"># 0.9692099</span></code></pre></td></tr></table>
</div>
</div>
<p>y no podría descartarse la hipótesis de independencia.</p>
<p>Es habitual realizar una representación gráfica de los principales efectos, típicamente los dos primeros. Por ejemplo, el comando <code>biplot(corresp(a, nf = 2))</code> produce</p>
<p><a href="http://www.datanalytics.com/wp-uploads/2011/08/biplot_correspondence_analysis.png"><img src="http://www.datanalytics.com/wp-uploads/2011/08/biplot_correspondence_analysis.png" alt="">
</a></p>
<p>Este gráfico, de alguna manera, representa los vectores $latex p_1, p_2, q_1$ y $latex q_2$. Y digo <em>de alguna manera</em> porque aplica cierta normalización sobre los mismos. Admito que siempre me ha sorprendido que puedan representarse churras y merinas (filas y columnas, quiero decir) sobre los mismos ejes de una manera que tenga sentido. Y el sentido es el siguiente: en la matriz $latex B$ habrá una entrada para la combinación <em>black</em>/<em>blue</em> (ojos azules, pelo negro). Como los valores de dichos puntos en el eje X son opuestos (y relativamente grandes), la contribución de la primera componente de la descomposición en dicha entrada, el producto de las dos coordenadas, será grande (en valor absoluto) y negativo: ¡ojos claros deberían corresponderse con pelo claro! En la segunda componente (eje Y), ambas variables tienen valores positivos aunque de valor sustancialmente menor. El producto de ambas coordenadas corrige el valor inicial.</p>
<p>De hecho, examinando las coordenadas Y (correspondientes a la segunda componente) podemos comprender mejor qué fenómeno recoge la segunda componente: una cierta sobreabundancia de personas con ojos claros y pelo oscuro y viceversa. Y a la vez, una proporción mayor de <em>medium</em>/<em>medium</em> de la que se deduciría únicamente de la primera componente.</p>
<p>Los interesados en abundar más sobre el el asunto y aprender técnicas adicionales de representación gráfica de este tipo de datos pueden echarle un vistazo al artículo <em><a href="http://cran.r-project.org/web/packages/anacor/vignettes/anacor.pdf">Simple and Canonical Correspondence Analysis Using the R Package<code>anacor</code></a></em> de J. de Leeuw y P. Mair.</p>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/estad%C3%ADstica/" rel="tag">estadística</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/r/" rel="tag">r</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/tablas-de-contingencia/" rel="tag">tablas de contingencia</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/cca/" rel="tag">cca</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/svd/" rel="tag">svd</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/anacor/" rel="tag">anacor</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/2011/08/12/una-feliz-conjuncion-estadistico-algebraica/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Anterior</span>
			<p class="pager__title">Una feliz conjunción estadístico-algebraica</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/2011/08/17/google-motorola-moviles-patentes-e-ideas/" rel="next">
			<span class="pager__subtitle">Siguiente&thinsp;»</span>
			<p class="pager__title">Google, Motorola, móviles, patentes e ideas</p>
		</a>
	</div>
</nav>


			</div>
			<aside class="sidebar">
<div class="widget-recent widget">
	<h4 class="widget__title">Más Recientes</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/2021/12/09/mas-sobre-exceso-mortalidad-noviembre-2021/">Sobre el exceso de mortalidad en noviembre de 2021</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/12/09/mas-sobre-la-estimacion-de-probabilidades-de-eventos-que-no-se-repiten/">Más sobre la estimación de probabilidades de eventos que no se repiten</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/12/07/estadistica-vs-siquiatria-la-aparente-contradiccion-la-profunda-sintesis/">Estadística vs siquiatría: la aparente contradicción, la profunda síntesis</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/12/02/por-que-cabe-argumentar-que-estos-resultados-infraestiman-la-efectividad-de-las-vacunas-contra-el-covid/">¿Por qué cabe argumentar que estos resultados infraestiman la efectividad de las vacunas contra el covid?</a></li>
			<li class="widget__item"><a class="widget__link" href="/2021/11/25/un-episodio-relevante-para-estas-paginas-extraido-de-un-espia-perfecto/">Un episodio relevante para estas páginas extraído de &#34;Un espía perfecto&#34;</a></li>
		</ul>
	</div>
</div>
</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2021 datanalytics.
      
		</div>
	</div>
</footer>

	</div>
<script async defer src="/js/menu.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({ tex2jax: {inlineMath: [["$","$"], ["$latex", "$"],["\\(","\\)"]]} })
</script>

</body>
</html>